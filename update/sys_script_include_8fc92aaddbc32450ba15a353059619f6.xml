<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_script_include">
    <sys_script_include action="INSERT_OR_UPDATE">
        <access>package_private</access>
        <active>false</active>
        <api_name>x_snc_datasilos.AppInstall</api_name>
        <caller_access/>
        <client_callable>false</client_callable>
        <description>The AppInstall() function is experimental. Use at your own risk! </description>
        <name>AppInstall</name>
        <script><![CDATA[function AppInstall()
{
	function Log(strText)
	{
		x_snc_datasilos.Log('AppInstall: '+strText);
	}
	function AppInstallTable(strTable)
	{
		Log('AppInstallTable: ['+strTable+']');
		
		var grACL = new GlideRecord('sys_security_acl');
		var condition = grACL.addQuery('name','=',strTable);
		condition.addOrCondition('name','=',strTable+'.*');
		grACL.addActiveQuery();
		grACL.addQuery('operation','=','read');
		grACL.query();
		while (grACL.next())
		{
			Log('Active ACL found: '+grACL.name+' / '+grACL.operation+' / '+grACL.sys_id);
			if (grACL.advanced == false)
			{
				Log('ACL is not set to advanced. Adding script...');
				grACL.advanced = true;
				grACL.script = 'answer = x_snc_datasilos.ExecuteACL(current);';
				var bResult = GlideRecordUpdate(grACL);
				Log('Update() returned: '+x_snc_devtools.RenderValue(bResult));
			}
			else
			{
				// In that case we would have to modify the existing script....maybe later!
			}
		}
		
	}
	
	var aTables = x_snc_datasilos.GetAllSupportedTables();
	for (nIndex = 0; nIndex < aTables.length; nIndex++)
	{
		AppInstallTable(aTables[nIndex]);
	}
	
	MaintenanceDatabaseViews();
}]]></script>
        <sys_class_name>sys_script_include</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2021-03-22 10:49:05</sys_created_on>
        <sys_id>8fc92aaddbc32450ba15a353059619f6</sys_id>
        <sys_mod_count>8</sys_mod_count>
        <sys_name>AppInstall</sys_name>
        <sys_package display_value="DataSilos" source="x_snc_datasilos">dafbffebdbb78450ba15a353059619eb</sys_package>
        <sys_policy>read</sys_policy>
        <sys_scope display_value="DataSilos">dafbffebdbb78450ba15a353059619eb</sys_scope>
        <sys_update_name>sys_script_include_8fc92aaddbc32450ba15a353059619f6</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2021-06-17 09:29:10</sys_updated_on>
    </sys_script_include>
</record_update>

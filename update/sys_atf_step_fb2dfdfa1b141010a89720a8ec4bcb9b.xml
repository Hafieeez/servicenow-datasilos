<?xml version="1.0" encoding="UTF-8"?><record_update table="sys_atf_step">
    <sys_atf_step action="INSERT_OR_UPDATE">
        <active>true</active>
        <copied_from display_value="Run Server Side Script">b3d210e61b9490d0a89720a8ec4bcbe5</copied_from>
        <description>Run Server Side Validation Script</description>
        <display_name>Run Server Side Script</display_name>
        <inputs/>
        <mugshots_cache_json/>
        <notes>Verify that the users A1 and A2 und silos have been set up properly</notes>
        <order>27</order>
        <snapshot/>
        <step_config display_value="Run Server Side Script">41de4a935332120028bc29cac2dc349a</step_config>
        <sys_class_name>sys_atf_step</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-04-24 15:35:32</sys_created_on>
        <sys_id>fb2dfdfa1b141010a89720a8ec4bcb9b</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_name>Run Server Side Script</sys_name>
        <sys_package display_value="DataSilos" source="x_snc_datasilos">dafbffebdbb78450ba15a353059619eb</sys_package>
        <sys_policy/>
        <sys_scope display_value="DataSilos">dafbffebdbb78450ba15a353059619eb</sys_scope>
        <sys_update_name>sys_atf_step_fb2dfdfa1b141010a89720a8ec4bcb9b</sys_update_name>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-04-24 15:35:32</sys_updated_on>
        <table/>
        <test display_value="DataSilos - Incident Task - Cross-silo">262df9fa1b141010a89720a8ec4bcbe3</test>
        <timeout/>
        <warning_message/>
    </sys_atf_step>
    <sys_variable_value action="delete_multiple" query="document_key=fb2dfdfa1b141010a89720a8ec4bcb9b"/>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_atf_step</document>
        <document_key>fb2dfdfa1b141010a89720a8ec4bcb9b</document_key>
        <order>200</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-04-24 15:35:32</sys_created_on>
        <sys_id>bb2dfdfa1b141010a89720a8ec4bcb9c</sys_id>
        <sys_mod_count>1</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-04-24 15:35:32</sys_updated_on>
        <value>(function(outputs, steps, stepResult, assertEqual) {&#13;
&#13;
function GetGroupsFromUser(strUserSysId)&#13;
{&#13;
	strUserSysId = ''+strUserSysId;&#13;
	var aGroups = [];&#13;
	var grUser = new GlideRecord('sys_user');&#13;
	if (grUser.get(strUserSysId) == null)&#13;
	{&#13;
		return aGroups;&#13;
	}&#13;
	var grUserGroups = new GlideRecord('sys_user_grmember');&#13;
	grUserGroups.addQuery('user','=',strUserSysId);&#13;
	grUserGroups.query();&#13;
	while(grUserGroups.next())&#13;
	{&#13;
		aGroups.push(grUserGroups.getValue('group'));&#13;
	}&#13;
	return aGroups;&#13;
}&#13;
	&#13;
	&#13;
/*&#13;
function RenderValue(vValue, nLevel)&#13;
{&#13;
	nLevel = parseInt(nLevel);&#13;
	var strLevel = '___';&#13;
	strLevel = strLevel.repeat(nLevel);&#13;
	&#13;
	var bIsObject = vValue instanceof Object;&#13;
	var strTypeOf = typeof vValue;&#13;
&#13;
	if (vValue === undefined)&#13;
	{&#13;
		return 'undefined';&#13;
	}&#13;
	if (vValue === null)&#13;
	{&#13;
		return 'null';&#13;
	}&#13;
&#13;
	var strOutput = '';&#13;
	&#13;
	if (Array.isArray(vValue))&#13;
	{&#13;
		if (vValue.length == 0)&#13;
		{&#13;
			strOutput += strLevel+'[]';&#13;
		}&#13;
		else&#13;
		{&#13;
			vValue.forEach( function(vElement,nKey)&#13;
			{&#13;
				strOutput += '\n'+strLevel+'['+nKey+']: '+RenderValue(vElement,nLevel+1);&#13;
			});&#13;
		}&#13;
	}&#13;
	else if (bIsObject || (strTypeOf == 'object'))&#13;
	{&#13;
		if (vValue.getValue == undefined)&#13;
		{&#13;
			Object.keys(vValue).forEach( function(strKey)&#13;
			{&#13;
				strOutput += '\n'+strLevel+'["'+strKey+'"]: '+RenderValue(''+vValue[strKey],nLevel+1);&#13;
			});&#13;
		}&#13;
		else&#13;
		{&#13;
			Object.keys(vValue).forEach( function(strKey)&#13;
			{&#13;
				strOutput += '\n'+strLevel+'["'+strKey+'"]: '+RenderValue(vValue.getValue(strKey),nLevel+1);&#13;
			});&#13;
		}&#13;
	}&#13;
	else&#13;
	{&#13;
		strOutput += ''+vValue;&#13;
	}&#13;
	return strOutput;&#13;
}&#13;
*/&#13;
	/*&#13;
	function RenderValue(vValue)&#13;
	{&#13;
		return ''+vValue;&#13;
	}&#13;
	*/&#13;
	&#13;
	/*&#13;
	var RenderValue = x_snc_devtools.RenderValue;&#13;
	var Debug = x_snc_devtools.Debug;&#13;
	Debug('Verify the creation of users during the InitializeRecords test');&#13;
	&#13;
	stepUserA1 = steps('972dbdfa1b141010a89720a8ec4bcbe3');&#13;
	//Debug(RenderValue(stepUserA1));&#13;
	stepUserA2 = steps('eb2dfdfa1b141010a89720a8ec4bcb3f');&#13;
	//Debug(RenderValue(stepUserA2));&#13;
	&#13;
	var strUserA1 = stepUserA1.user.toString();&#13;
	var strUserA2 = stepUserA2.user.toString();&#13;
&#13;
	&#13;
	Debug('User A1: '+strUserA1);&#13;
	Debug('User A2: '+strUserA2);&#13;
	&#13;
	//var GetGroupsFromUser = x_snc_devtools.GetGroupsFromUser;&#13;
	&#13;
	var aUserA1Groups = GetGroupsFromUser(strUserA1);&#13;
	var aUserA2Groups = GetGroupsFromUser(strUserA2);&#13;
&#13;
	Debug('Groups A1: '+RenderValue(aUserA1Groups));&#13;
	Debug('Groups A2: '+RenderValue(aUserA2Groups));&#13;
	&#13;
	if (aUserA1Groups.length == 0)&#13;
	{&#13;
		Debug('Error: A1 has no groups!');&#13;
		return false;&#13;
	}&#13;
	if (aUserA2Groups.length == 0)&#13;
	{&#13;
		Debug('Error: A2 has no groups!');&#13;
&#13;
		return false;&#13;
	}&#13;
	&#13;
	var aUserA1Silos = GetSilosFromUser(strUserA1);&#13;
	var aUserA2Silos = GetSilosFromUser(strUserA2);&#13;
&#13;
	Debug('Silos A1: '+RenderValue(aUserA1Silos));&#13;
	Debug('Silos A2: '+RenderValue(aUserA2Silos));&#13;
	&#13;
	if (aUserA1Silos.length == 0)&#13;
	{&#13;
		Debug('Error: User A1 has no silos!');&#13;
		return false;&#13;
	}&#13;
	if (aUserA2Silos.length == 0)&#13;
	{&#13;
		Debug('Error: User A2 has no silos!');&#13;
		return false;&#13;
	}&#13;
	*/&#13;
	&#13;
	return true;&#13;
&#13;
	&#13;
	&#13;
})(outputs, steps, stepResult, assertEqual);&#13;
// uncomment the next line to execute this script as a jasmine test&#13;
//jasmine.getEnv().execute();&#13;
</value>
        <variable display_value="">989d9e235324220002c6435723dc3484</variable>
    </sys_variable_value>
    <sys_variable_value action="INSERT_OR_UPDATE">
        <document>sys_atf_step</document>
        <document_key>fb2dfdfa1b141010a89720a8ec4bcb9b</document_key>
        <order>100</order>
        <sys_class_name>sys_variable_value</sys_class_name>
        <sys_created_by>admin</sys_created_by>
        <sys_created_on>2020-04-24 15:35:32</sys_created_on>
        <sys_id>f72dfdfa1b141010a89720a8ec4bcb9c</sys_id>
        <sys_mod_count>0</sys_mod_count>
        <sys_updated_by>admin</sys_updated_by>
        <sys_updated_on>2020-04-24 15:35:32</sys_updated_on>
        <value>3.1</value>
        <variable display_value="">42f2564b73031300440211d8faf6a777</variable>
    </sys_variable_value>
</record_update>
